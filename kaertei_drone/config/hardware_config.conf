# =====================================================================
# KAERTEI 2025 FAIO - Hardware Configuration File
# Raspberry Pi 5 + Pixhawk4 Configuration
# =====================================================================

[flight_controller]
# Pixhawk4 PX4 - Only handles 6 motors + GPS
connection_port = /dev/ttyUSB0
baud_rate = 57600
connection_timeout = 10
heartbeat_timeout = 5

[cameras]
# 2x USB Cameras handled by Raspberry Pi 5 (top camera temporarily not available)
front_camera_index = 0
back_camera_index = 2
# top_camera_index = 4  # TEMPORARILY DISABLED - NOT AVAILABLE

# Camera settings optimized for Pi 5
camera_width = 640
camera_height = 480
camera_fps = 30
camera_format = MJPG

# Camera mounting offsets (pixels from center)
front_camera_offset_x = 0
front_camera_offset_y = 0
back_camera_offset_x = 0
back_camera_offset_y = -10
top_camera_offset_x = 0
top_camera_offset_y = 0

[gpio_pins]
# Raspberry Pi 5 GPIO Configuration
# 2x Relay control for electromagnets
front_magnet_relay_pin = 18
back_magnet_relay_pin = 19
relay_active_high = false

# Status indicators
status_led_pin = 21
error_led_pin = 20
emergency_stop_pin = 16

[sensors]
# 3x LiDAR Range Finders (TF Mini Plus)
# Connected via USB serial adapters
lidar_front_interface = /dev/ttyUSB1
lidar_left_interface = /dev/ttyUSB2
lidar_right_interface = /dev/ttyUSB3
lidar_baud_rate = 115200
lidar_max_range = 12.0
lidar_detection_threshold = 2.0
lidar_sample_rate = 100

# I2C bus (for future expansion)
i2c_bus = 1

[flight]
# Flight parameters
takeoff_altitude = 1.0
max_horizontal_velocity = 2.5
max_vertical_velocity = 1.5
max_yaw_rate = 45.0

# Safety limits
max_altitude_limit = 15.0
geofence_radius = 150.0
battery_failsafe_voltage = 14.4

[MISSION]
# Mission configuration
debug_mode = true
checkpoint_timeout = 180
indoor_altitude = 1.0
outdoor_altitude = 3.0
turn_direction = right

[GPS_WAYPOINTS]
# Competition GPS coordinates (Jakarta area - update for competition)
home_lat = -6.365500
home_lon = 106.824500
home_alt = 0.0

# NOTE: Waypoint 1-5 will be retrieved from PX4/ArduPilot AFTER successful bucket drop
# These are placeholder coordinates for system initialization only
waypoint_1_lat = -6.365000
waypoint_1_lon = 106.825000
waypoint_1_alt = 30.0

waypoint_2_lat = -6.364500
waypoint_2_lon = 106.825500
waypoint_2_alt = 30.0

waypoint_3_lat = -6.364000
waypoint_3_lon = 106.826000
waypoint_3_alt = 30.0

[waypoints]
# MISSION LOGIC: Pickup and drop locations follow 12-checkpoint mission logic
# NO FIXED WAYPOINTS for pickup/drop - determined by mission checkpoints
# Waypoints 1-5 retrieved from PX4/ArduPilot after successful bucket drop

# Outdoor mission parameters (for reference only)
outdoor_pickup_latitude = -6.365000
outdoor_pickup_longitude = 106.825000
outdoor_pickup_altitude = 30.0

outdoor_drop_latitude = -6.364500
outdoor_drop_longitude = 106.825500
outdoor_drop_altitude = 30.0

gps_accuracy_threshold = 2.0
waypoint_reached_threshold = 3.0

[vision]
# Computer vision settings
detection_confidence_threshold = 0.6
alignment_tolerance_pixels = 25
min_object_area = 1200

# YOLO Model Paths - FRONT and BACK cameras only (top camera temporarily not available)
models_directory = /home/vanszs/ros/Dirgagah-KAERTEI/kaertei_drone/models
general_model = yolov8n.pt
exit_gate_model = yolov8n.pt
objects_model = yolov8n.pt
dropzone_model = yolov8n.pt
debug_visualization = true

# NOTE: Top camera temporarily disabled - YOLO only for front and back cameras

# Color detection ranges (HSV)
red_lower_hue = 0
red_upper_hue = 10
red_lower_saturation = 100
red_upper_saturation = 255
red_lower_value = 100
red_upper_value = 255

blue_lower_hue = 100
blue_upper_hue = 130
blue_lower_saturation = 100
blue_upper_saturation = 255
blue_lower_value = 100
blue_upper_value = 255

green_lower_hue = 50
green_upper_hue = 80
green_lower_saturation = 100
green_upper_saturation = 255
green_lower_value = 100
green_upper_value = 255

[timing]
# Hardware operation delays
magnet_activation_delay = 1.0
magnet_deactivation_delay = 0.5
camera_startup_delay = 2.0
descent_pickup_time = 4.0
ascent_after_pickup_time = 3.0

# Detection timeouts
object_detection_timeout = 45.0
alignment_timeout = 20.0
dropzone_search_timeout = 60.0

# Mission timeouts
checkpoint_timeout = 120
mission_total_timeout = 1200

[debug]
# Debug and logging
log_level = INFO
log_directory = /tmp/kaertei_logs
enable_checkpoint_logging = true
enable_sensor_logging = false
enable_camera_recording = false
enable_flight_data_logging = true
